<Window x:Class="PersonalNotesApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:PersonalNotesApp.Model" xmlns:viewmodel="clr-namespace:PersonalNotesApp.ViewModel" d:DataContext="{d:DesignInstance Type=viewmodel:MainViewModel}"
        xmlns:conv="clr-namespace:PersonalNotesApp.Converter"
        mc:Ignorable="d"
        Title="MainWindow" Height="450" Width="800">

    <Window.Resources>
        <conv:FlowDocumentToString x:Key="flowConverter" />
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="50"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="200"  />
            <ColumnDefinition Width="5" />
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <Menu Grid.Row="0" Grid.ColumnSpan="3" Background="LightGray" Margin="0,0,0,30"  >
            <MenuItem Header="Arquivo">
                <MenuItem Header="Adicionar Pasta" Click="AdicionaNovaPasta_Click" />
                <MenuItem Header="Adicionar Anotação" Click="AdicionaNovaAnotacao_Click" />
                <MenuItem Header="Carregar" Click="CarregarPastasEnotas_Click" />
                <MenuItem Header="Salvar" Click="Salvar_Click"/>
                <MenuItem Header="Sair" Click="Sair_Click"/>
            </MenuItem>
            <MenuItem Header="Formatar">
                <MenuItem Header="Negrito" />
                <MenuItem Header="Itálico" />
                <MenuItem Header="Sublinhado" />
            </MenuItem>
        </Menu>
        <TreeView x:Name="tv_Main" Grid.Column="0" Grid.Row="1" Margin="5" ItemsSource="{Binding Pastas}" 
                  SelectedItemChanged="tv_Main_SelectedItemChanged" MouseDoubleClick="tv_Main_MouseDoubleClick" >
            <TreeView.Resources>
                <HierarchicalDataTemplate DataType="{x:Type local:Pasta}" ItemsSource="{Binding SubPastas}">
                    <Grid>
                        <Grid.Resources>
                            <Style TargetType="TextBox">
                                <Setter Property="Visibility" Value="Collapsed" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding EditaNome}" Value="True">
                                        <Setter Property="Visibility" Value="Visible" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>

                            <Style TargetType="TextBlock">
                                <Setter Property="Visibility" Value="Visible" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding EditaNome}" Value="True">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Grid.Resources>
                        <TextBox Text="{Binding Nome, UpdateSourceTrigger=PropertyChanged}" LostFocus="TextBox_LostFocus" />
                        <TextBlock Text="{Binding Nome}">
                            <TextBlock.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Header="Adicionar SubPasta" Click="AdicionaSubPasta_Click"/>
                                    <MenuItem Header="Adicionar Anotação" Click="AdicionaNovaAnotacaoEmSubPasta_Click"/>
                                </ContextMenu>
                            </TextBlock.ContextMenu>
                        </TextBlock>
                    </Grid>
                </HierarchicalDataTemplate>

                <DataTemplate DataType="{x:Type local:Anotacao}">
                    <TextBlock Text="{Binding Nome}" />
                </DataTemplate>
            </TreeView.Resources>
        </TreeView>
        <GridSplitter Grid.Column="1" Grid.Row="1" Width="5" Background="Gray" Cursor="SizeWE" />

        <Grid Grid.Column="2" Grid.Row="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="50" />
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <TextBox Grid.Row="0" Margin="5" Text="{Binding ItemSelecionado.Nome, UpdateSourceTrigger=PropertyChanged}"/>
            
            
            
            <RichTextBox x:Name="rtbConteudo" Grid.Row="1" Margin="5" >
                <RichTextBox.Document>
                    <FlowDocument>
                        <Paragraph>
                            <Run/>
                        </Paragraph>
                    </FlowDocument>
                </RichTextBox.Document>
            </RichTextBox>
        </Grid>
    </Grid>
</Window>
